{% extends '/components/merlin/steps/base.twig' %}

{% block slide_body_video_section_blurb %}
	<p>
		Automatically blocking malicious IP addresses is Shield's most crucial security feature.
	</p>
	<p>When you block bad IPs, you stop all security problems associated with those bad bots, such as:</p>
	<ul class="list-group  mb-3">
		<li class="list-group-item list-group-item-action">brute force login attacks</li>
		<li class="list-group-item list-group-item-action">exploitation of current and future vulnerabilities within plugins/themes on your site</li>
		<li class="list-group-item">malware injection and exploitation</li>
		<li class="list-group-item">automated comment SPAM</li>
		<li class="list-group-item">resource depletion through DoS attacks, excessive probing and any forceful hacking attempts</li>
	</ul>
	<p>Shield monitors every IP address that connects to your site.
	   When they do something bad, such as a failed login, it starts an "offense counter".</p>
	<p>When the offense counter hits your limit (default: 10), the IP address is blocked completely.</p>
{% endblock %}

{% block slide_body_action_area %}

	<form class="form-horizontal merlin-form ajax-form">

		<div class="row">
			<div class="col-4">
				Configure IP Blocking
			</div>
			<div class="col-8">
				{{ icwp_macros.formInput_Number( 'offenses', vars.offense_limit, 'Offense Limit', null,
					'We recommend somewhere between 5 and 10. The smaller the limit, the stricter Shield will be.',null
				) }}

				<div class="form-group row mt-3">
					<label class="col-4 col-form-label" for="_block_length">Block Length</label>
					<div class="col-8">
						<select name="block_length" id="_block_length">
							<option value="day">1 Day</option>
							<option value="week">1 Week</option>
							<option value="month">1 Month</option>
						</select>
						<small class="form-text text-muted d-block">
							Malicious IPs should be blocked for at least a day.
						</small>
					</div>
				</div>

				<div class="mt-3"></div>
				{{ icwp_macros.formInput_Checkbox(
					'cs_block', 'Y', 'Crowd-Sourced IPs',
					'Use CrowdSec Blocklists'~' <span class="badge text-bg-success">NEW</span>',
					"Crowd-sourced IP block-lists involves sharing your IP block-list with others, and they share them with you."
					~'[<a href="https://shsec.io/l7" target="_blank">more info</a>]',
					null, true
				) }}

				<div class="mt-3"></div>
				{{ icwp_macros.formInput_Hidden( 'step_slug', vars.step_slug ) }}
				{{ icwp_macros.formInput_Submit2( 'Set IP Blocking Options', null, null, false, 'mt-2' ) }}
			</div>
		</div>

	</form>
{% endblock %}