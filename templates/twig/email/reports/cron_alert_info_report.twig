{% extends '/email/base_email.twig' %}

{% block email_body %}
	<p style="margin: 0 0 10px; font-size: 14px; color: #333;">
		{{ body.strings.please_find }}
	</p>
	<p style="margin: 0 0 15px; font-size: 13px; color: #555;">
		{{ body.strings.site_url }}: <strong>{{ body.vars.site_url }}</strong>
	</p>

	{% for report in body.vars.reports %}
		{# Report Header #}
		<table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; margin-bottom: 5px;">
			<tr>
				<td style="height: 4px; background-color: #008000; font-size: 0; line-height: 0;">&nbsp;</td>
			</tr>
			<tr>
				<td style="background-color: #f8f9f8; padding: 10px 14px; border-left: 4px solid #008000; border-radius: 0 4px 4px 0;">
					<strong style="font-size: 15px; color: #333;">{{ report.type }}</strong>
					<br>
					<span style="font-size: 12px; color: #777;">
						{{ body.strings.period }}: {{ report.date_start }} &ndash; {{ report.date_end }}
					</span>
				</td>
			</tr>
		</table>

		{# Scans area (both ALERT and INFO reports) #}
		{% if report.areas_data.scans is defined %}
			{% if report.areas_data.scans.scan_results is defined and report.areas_data.scans.scan_results|length > 0 %}
				{% include '/email/reports/areas/scans_results.twig' with {
					scan_counts: report.areas_data.scans.scan_results,
					section_title: body.strings.section_scans,
					strings: body.strings
				} only %}
			{% endif %}

			{% if report.areas_data.scans.scan_repairs is defined %}
				{% include '/email/reports/areas/scans_repairs.twig' with {
					scan_repairs: report.areas_data.scans.scan_repairs,
					strings: body.strings
				} only %}
			{% endif %}
		{% endif %}

		{# Changes area (INFO reports) #}
		{% if report.areas_data.changes is defined %}
			{% include '/email/reports/areas/changes.twig' with {
				changes: report.areas_data.changes,
				strings: body.strings,
				detail_level: body.vars.detail_level
			} only %}
		{% endif %}

		{# Statistics area (INFO reports) #}
		{% if report.areas_data.statistics is defined and report.areas_data.statistics|length > 0 %}
			{% include '/email/reports/areas/stats.twig' with {
				stats: report.areas_data.statistics,
				strings: body.strings,
				detail_level: body.vars.detail_level
			} only %}
		{% endif %}

		{# View Full Report Button #}
		<table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="margin: 20px 0 25px;">
			<tr>
				<td align="center">
					<a href="{{ report.href }}"
					   target="_blank"
					   style="display: inline-block; padding: 10px 24px; background-color: #008000; color: #ffffff; text-decoration: none; font-size: 14px; font-weight: bold; border-radius: 8px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">
						{{ body.strings.view_full_report }} &rarr;
					</a>
				</td>
			</tr>
		</table>

		{% if not loop.last %}
			<hr style="border: none; border-top: 1px solid #d9dfd9; margin: 10px 0 20px;">
		{% endif %}
	{% endfor %}
{% endblock %}
