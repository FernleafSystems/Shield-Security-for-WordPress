{% extends '/wpadmin/plugin_pages/base_inner_page.twig' %}

{% block inner_page_body %}
	{% include '/wpadmin/components/investigate/lookup_strip.twig' with {
		action: hrefs.by_plugin,
		lookup_route: vars.lookup_route,
		label: strings.lookup_label,
		input_name: 'plugin_slug',
		input_type: 'select',
		input_value: vars.plugin_slug|default(''),
		placeholder: strings.lookup_placeholder,
		options: vars.plugin_options|default([]),
		submit_text: strings.lookup_submit
	} only %}

	{% if not flags.has_subject %}
		<div class="alert alert-warning mb-0">
			<strong>{{ flags.subject_not_found ? strings.not_found_title : strings.no_subject_title }}</strong>
			<div>{{ flags.subject_not_found ? strings.not_found_text : strings.no_subject_text }}</div>
		</div>
	{% else %}
		{% set panes = [
			{
				id: vars.tabs.overview.pane_id,
				nav_id: vars.tabs.overview.nav_id,
				is_active: true,
				body_include: '/wpadmin/components/investigate/overview_table.twig',
				body_vars: {
					title: strings.overview_title,
					rows: vars.overview_rows
				}
			},
			{
				id: vars.tabs.file_status.pane_id,
				nav_id: vars.tabs.file_status.nav_id,
				is_active: false,
				body_include: '/wpadmin/components/investigate/table_container.twig',
				body_vars: {
					table: vars.tables.file_status
				}
			},
			{
				id: vars.tabs.vulnerabilities.pane_id,
				nav_id: vars.tabs.vulnerabilities.nav_id,
				is_active: false,
				body_include: '/wpadmin/components/investigate/vulnerabilities_panel.twig',
				body_vars: {
					vulnerabilities: vars.vulnerabilities
				}
			},
			{
				id: vars.tabs.activity.pane_id,
				nav_id: vars.tabs.activity.nav_id,
				is_active: false,
				body_include: '/wpadmin/components/investigate/table_container.twig',
				body_vars: {
					table: vars.tables.activity
				}
			}
		] %}
		{% include '/wpadmin/components/investigate/page_shell.twig' with {
			nav_id: 'ShieldInvestigateByPluginTabsNav',
			nav_items: vars.rail_nav_items,
			panes: panes
		} only %}
	{% endif %}
{% endblock %}
