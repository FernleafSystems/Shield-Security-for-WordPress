{% extends '/wpadmin/plugin_pages/base_inner_page.twig' %}

{% block inner_page_body %}
	{% include '/wpadmin/components/investigate/lookup_strip.twig' with {
		action: hrefs.by_plugin,
		lookup_route: vars.lookup_route,
		label: strings.lookup_label,
		input_name: 'plugin_slug',
		input_type: 'select',
		input_value: vars.plugin_slug|default(''),
		placeholder: strings.lookup_placeholder,
		options: vars.plugin_options|default([]),
		submit_text: strings.lookup_submit
	} only %}

	{% if not flags.has_subject %}
		<div class="alert alert-warning mb-0">
			<strong>{{ flags.subject_not_found ? strings.not_found_title : strings.no_subject_title }}</strong>
			<div>{{ flags.subject_not_found ? strings.not_found_text : strings.no_subject_text }}</div>
		</div>
	{% else %}
		<div class="options_form_for--modern">
			<div class="shield-options-layout has-rail">
				<aside class="shield-options-rail">
					<div class="shield-options-rail-accent"></div>
					{% include '/components/config/options_rail_tabs.twig' with {
						nav_id: 'ShieldInvestigateByPluginTabsNav',
						nav_items: vars.rail_nav_items
					} only %}
				</aside>

				<div class="shield-options-content">
					<div class="tab-content">
						<section class="tab-pane shield-options-panel active show"
								 id="{{ vars.tabs.overview.pane_id }}"
								 role="tabpanel"
								 aria-labelledby="{{ vars.tabs.overview.nav_id }}">
							<div class="shield-options-panel-accent"></div>
							<div class="shield-options-panel-body">
								{% include '/wpadmin/components/investigate/overview_table.twig' with {
									title: strings.overview_title,
									rows: vars.overview_rows
								} only %}
							</div>
						</section>

						<section class="tab-pane shield-options-panel"
								 id="{{ vars.tabs.file_status.pane_id }}"
								 role="tabpanel"
								 aria-labelledby="{{ vars.tabs.file_status.nav_id }}">
							<div class="shield-options-panel-accent"></div>
							<div class="shield-options-panel-body">
								{% include '/wpadmin/components/investigate/table_container.twig' with {
									table: vars.tables.file_status
								} only %}
							</div>
						</section>

						<section class="tab-pane shield-options-panel"
								 id="{{ vars.tabs.vulnerabilities.pane_id }}"
								 role="tabpanel"
								 aria-labelledby="{{ vars.tabs.vulnerabilities.nav_id }}">
							<div class="shield-options-panel-accent"></div>
							<div class="shield-options-panel-body">
								<div class="card shield-card status-{{ vars.vulnerabilities.status|default('info') }}">
									<div class="shield-card-accent status-{{ vars.vulnerabilities.status|default('info') }}"></div>
									<div class="card-body">
										<div class="d-flex justify-content-between align-items-start gap-2">
											<div>
												<h5 class="card-title mb-2">{{ vars.vulnerabilities.title|default('') }}</h5>
												<p class="mb-0">{{ vars.vulnerabilities.summary|default('') }}</p>
											</div>
											{% if vars.vulnerabilities.lookup_href|default('') is not empty %}
												<a href="{{ vars.vulnerabilities.lookup_href }}" target="_blank" class="btn btn-outline-secondary btn-sm">{{ vars.vulnerabilities.lookup_text|default('Lookup') }}</a>
											{% endif %}
										</div>
									</div>
								</div>
							</div>
						</section>

						<section class="tab-pane shield-options-panel"
								 id="{{ vars.tabs.activity.pane_id }}"
								 role="tabpanel"
								 aria-labelledby="{{ vars.tabs.activity.nav_id }}">
							<div class="shield-options-panel-accent"></div>
							<div class="shield-options-panel-body">
								{% include '/wpadmin/components/investigate/table_container.twig' with {
									table: vars.tables.activity
								} only %}
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
	{% endif %}
{% endblock %}
