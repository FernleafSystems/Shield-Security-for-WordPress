{% extends '/wpadmin/plugin_pages/base_inner_page.twig' %}

{% block inner_page_body %}
	{% include '/wpadmin/components/investigate/lookup_strip.twig' with {
		action: hrefs.by_user,
		lookup_route: vars.lookup_route,
		label: strings.lookup_label,
		input_name: 'user_lookup',
		input_type: 'text',
		input_value: vars.user_lookup|default(''),
		placeholder: strings.lookup_placeholder,
		submit_text: strings.lookup_submit
	} only %}

	{% if not flags.has_subject %}
		<div class="alert alert-warning mb-0">
			<strong>{{ flags.subject_not_found ? strings.not_found_title : strings.no_subject_title }}</strong>
			<div>{{ flags.subject_not_found ? strings.not_found_text : strings.no_subject_text }}</div>
		</div>
	{% else %}
		{% set panes = [
			{
				id: 'tabInvestigateUserOverview',
				nav_id: 'tab-navlink-user-overview',
				is_active: true,
				body_include: '/wpadmin/components/investigate/overview_table.twig',
				body_vars: {
					title: strings.overview_title,
					rows: vars.overview_rows
				}
			},
			{
				id: 'tabInvestigateUserSessions',
				nav_id: 'tab-navlink-user-sessions',
				is_active: false,
				body_include: '/wpadmin/components/investigate/table_container.twig',
				body_vars: {
					table: vars.tables.sessions
				}
			},
			{
				id: 'tabInvestigateUserActivity',
				nav_id: 'tab-navlink-user-activity',
				is_active: false,
				body_include: '/wpadmin/components/investigate/table_container.twig',
				body_vars: {
					table: vars.tables.activity
				}
			},
			{
				id: 'tabInvestigateUserRequests',
				nav_id: 'tab-navlink-user-requests',
				is_active: false,
				body_include: '/wpadmin/components/investigate/table_container.twig',
				body_vars: {
					table: vars.tables.requests
				}
			},
			{
				id: 'tabInvestigateUserIps',
				nav_id: 'tab-navlink-user-ips',
				is_active: false,
				body_include: '/wpadmin/components/investigate/user_related_ips_panel.twig',
				body_vars: {
					strings: strings,
					related_ips: vars.related_ips
				}
			}
		] %}
		{% include '/wpadmin/components/investigate/page_shell.twig' with {
			nav_id: 'ShieldInvestigateByUserTabsNav',
			nav_items: vars.rail_nav_items,
			tab_content_class: 'investigate-by-user-content',
			panes: panes
		} only %}
	{% endif %}
{% endblock %}
