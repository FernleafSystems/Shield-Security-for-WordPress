<div class="card shield-card status-good">
	<div class="shield-card-accent status-good"></div>
	<div class="card-body">
		<h5 class="card-title mb-3">{{ strings.related_ips_title }}</h5>
		{% if related_ips|default([]) is empty %}
			<p class="mb-0">{{ strings.related_ips_empty }}</p>
		{% else %}
			<div class="row g-3">
				{% for related in related_ips %}
					<div class="col-12 col-md-6 col-xl-4">
						<div class="card shield-card h-100 investigate-by-user-ip-card status-{{ related.status|default('info') }}">
							<div class="shield-card-accent status-{{ related.status|default('info') }}"></div>
							<div class="card-body d-flex flex-column gap-2">
								<div class="d-flex justify-content-between align-items-start gap-2">
									<a href="{{ related.href }}"
									   class="offcanvas_ip_analysis ip-address fw-semibold"
									   data-ip="{{ related.ip }}">{{ related.ip }}</a>
									<span class="shield-badge badge-{{ related.status|default('info') }} status-{{ related.status|default('info') }} investigate-by-user-ip-status">{{ related.status_label|default('') }}</span>
								</div>
								{% if related.investigate_href|default('') is not empty %}
									<div>
										<a href="{{ related.investigate_href }}" class="btn btn-outline-secondary btn-sm">Investigate IP</a>
									</div>
								{% endif %}
								<div>
									<div>{{ related.last_seen_ago|default('-') }}</div>
									{% if related.last_seen_at|default('') is not empty %}
										<div class="timestamp-small">{{ related.last_seen_at }}</div>
									{% endif %}
								</div>
								<div class="small text-muted investigate-by-user-ip-counts">
									Sessions: {{ related.sessions_count|default(0) }} |
									Activity: {{ related.activity_count|default(0) }} |
									Requests: {{ related.requests_count|default(0) }}
								</div>
							</div>
						</div>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	</div>
</div>
