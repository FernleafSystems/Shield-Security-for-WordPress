{
  "slug":             "audit_trail",
  "properties":       {
    "slug":                  "audit_trail",
    "name":                  "Audit Trail",
    "sidebar_name":          "Audit Trail",
    "show_module_menu_item": false,
    "show_module_options":   true,
    "storage_key":           "audit_trail",
    "tagline":               "Track All Site Activity: Who, What, When and Where",
    "show_central":          true,
    "access_restricted":     true,
    "premium":               false,
    "run_if_whitelisted":    true,
    "run_if_verified_bot":   false,
    "run_if_wpcli":          true,
    "order":                 110
  },
  "menu_items":       [
    {
      "title": "Audit Trail",
      "slug":  "audit-redirect"
    }
  ],
  "custom_redirects": [
    {
      "source_mod_page": "audit-redirect",
      "target_mod_page": "insights",
      "query_args":      {
        "inav": "audit"
      }
    }
  ],
  "sections":         [
    {
      "slug":        "section_audit_trail_options",
      "primary":     true,
      "title":       "Audit Trail Options",
      "title_short": "Options",
      "beacon_id":   241,
      "summary":     [
        "Purpose - Provides finer control over the audit trail itself.",
        "Recommendation - These settings are dependent on your requirements."
      ]
    },
    {
      "slug":        "section_enable_plugin_feature_audit_trail",
      "title":       "Enable Module: Audit Trail",
      "title_short": "Disable Module",
      "beacon_id":   241,
      "summary":     [
        "Purpose - The Audit Trail is designed so you can look back on events and analyse what happened and what may have gone wrong.",
        "Recommendation - Keep the Audit Trail feature turned on."
      ]
    },
    {
      "slug":   "section_non_ui",
      "hidden": true
    }
  ],
  "options":          [
    {
      "key":         "enable_audit_trail",
      "section":     "section_enable_plugin_feature_audit_trail",
      "advanced":    true,
      "default":     "Y",
      "type":        "checkbox",
      "link_info":   "https://shsec.io/5p",
      "link_blog":   "https://shsec.io/a1",
      "beacon_id":   241,
      "name":        "Enable Audit Trail",
      "summary":     "Enable (or Disable) The Audit Trail module",
      "description": "Un-Checking this option will completely disable the Audit Trail module"
    },
    {
      "key":         "audit_trail_auto_clean",
      "section":     "section_audit_trail_options",
      "default":     14,
      "min":         1,
      "type":        "integer",
      "link_info":   "https://shsec.io/a2",
      "link_blog":   "https://shsec.io/a1",
      "beacon_id":   375,
      "name":        "Auto Clean",
      "summary":     "Enable Audit Auto Cleaning",
      "description": "Events older than the number of days specified will be automatically cleaned from the database"
    },
    {
      "key":         "audit_trail_max_entries",
      "section":     "section_audit_trail_options",
      "premium":     true,
      "default":     1000,
      "min":         0,
      "type":        "integer",
      "link_info":   "https://shsec.io/hc",
      "link_blog":   "",
      "beacon_id":   128,
      "name":        "Max Trail Length",
      "summary":     "Maximum Audit Trail Length To Keep",
      "description": "Automatically remove any audit trail entries when this limit is exceeded."
    }
  ],
  "definitions":      {
    "db_handler_classes":           {
      "at_logs": "\\FernleafSystems\\Wordpress\\Plugin\\Shield\\Modules\\AuditTrail\\DB\\Logs\\Ops\\Handler",
      "at_meta": "\\FernleafSystems\\Wordpress\\Plugin\\Shield\\Modules\\AuditTrail\\DB\\Meta\\Ops\\Handler"
    },
    "db_table_at_logs":             {
      "slug":           "at_logs",
      "has_updated_at": true,
      "has_created_at": true,
      "has_deleted_at": false,
      "cols_custom":    {
        "site_id":    {
          "macro_type": "unsigned_int",
          "default":    1,
          "comment":    "Site ID"
        },
        "event_id":   {
          "macro_type": "unsigned_int",
          "default":    0,
          "length":     6,
          "comment":    "Event ID"
        },
        "event_slug": {
          "macro_type": "varchar",
          "default":    "''",
          "comment":    "Event Slug"
        }
      }
    },
    "db_table_at_meta":             {
      "slug":           "at_meta",
      "has_updated_at": false,
      "has_created_at": false,
      "has_deleted_at": false,
      "cols_custom":    {
        "log_ref":    {
          "macro_type": "unsigned_int",
          "comment":    "Log ID"
        },
        "meta_key":   {
          "macro_type": "varchar",
          "length":     32,
          "comment":    "Meta Key"
        },
        "meta_value": {
          "macro_type": "text",
          "comment":    "Meta Data"
        }
      }
    },
    "db_classes":                   {
      "audit_trail": "\\FernleafSystems\\Wordpress\\Plugin\\Shield\\Databases\\AuditTrail\\Handler"
    },
    "db_table_audit_trail":         {
      "slug":           "audit_trail",
      "has_updated_at": true,
      "cols_custom":    {
        "rid":         "varchar(10) NOT NULL DEFAULT '' COMMENT 'Request ID'",
        "ip":          "varchar(40) NOT NULL DEFAULT 0 COMMENT 'Visitor IP Address'",
        "wp_username": "varchar(255) NOT NULL DEFAULT '-' COMMENT 'WP User'",
        "context":     "varchar(32) NOT NULL DEFAULT 'none' COMMENT 'Audit Context'",
        "event":       "varchar(50) NOT NULL DEFAULT 'none' COMMENT 'Specific Audit Event'",
        "category":    "int(3) UNSIGNED NOT NULL DEFAULT 0 COMMENT 'Severity'",
        "meta":        "text COMMENT 'Audit Event Data'",
        "count":       "SMALLINT(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT 'Repeat Count'"
      }
    },
    "audit_trail_free_max_entries": 100,
    "audit_trail_table_name":       "audit_trail",
    "events":                       {
      "plugin_activated":        {
        "context":        "plugins",
        "audit_multiple": true
      },
      "plugin_deactivated":      {
        "context":        "plugins",
        "audit_multiple": true
      },
      "plugin_file_edited":      {
        "context": "plugins"
      },
      "plugin_upgraded":         {
        "context":        "plugins",
        "audit_multiple": true
      },
      "theme_activated":         {
        "context": "themes"
      },
      "theme_file_edited":       {
        "context": "themes"
      },
      "theme_upgraded":          {
        "context":        "themes",
        "audit_multiple": true
      },
      "core_updated":            {
        "context": "wordpress"
      },
      "permalinks_structure":    {
        "context": "wordpress"
      },
      "post_deleted":            {
        "context":        "posts",
        "audit_multiple": true
      },
      "post_trashed":            {
        "context":        "posts",
        "audit_multiple": true
      },
      "post_recovered":          {
        "context":        "posts",
        "audit_multiple": true
      },
      "post_updated":            {
        "context":        "posts",
        "audit_multiple": true
      },
      "post_published":          {
        "context":        "posts",
        "audit_multiple": true
      },
      "post_unpublished":        {
        "context":        "posts",
        "audit_multiple": true
      },
      "user_login":              {
        "context": "users"
      },
      "user_login_app":          {
        "context": "users"
      },
      "user_registered":         {
        "context": "users"
      },
      "user_deleted":            {
        "context":        "users",
        "audit_multiple": true
      },
      "user_deleted_reassigned": {
        "context": "users"
      },
      "email_attempt_send":      {
        "context":        "emails",
        "audit_multiple": true
      },
      "email_send_invalid":      {
        "context":        "emails",
        "audit_multiple": true
      }
    }
  }
}