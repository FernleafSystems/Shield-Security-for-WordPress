{
  "rules": [
    {
      "name":       "Is IP Whitelisted",
      "slug":       "is_ip_whitelisted",
      "flags":      [
      ],
      "conditions": {
        "logic": "AND",
        "group": [
          {
            "action": "is_ip_whitelisted"
          }
        ]
      },
      "responses":  [
        {
          "action": "is_ip_whitelisted"
        }
      ]
    },
    {
      "name":       "Is IP Blocked",
      "slug":       "is_ip_blocked",
      "flags":      [
      ],
      "conditions": {
        "logic": "AND",
        "group": [
          {
            "action":       "is_ip_whitelisted",
            "invert_match": true
          },
          {
            "action": "is_ip_blocked"
          },
          {
            "action":       "is_ip_high_reputation",
            "invert_match": true
          }
        ]
      },
      "responses":  [
        {
          "action": "is_ip_blocked"
        }
      ]
    },
    {
      "name":       "Bot-Track 404",
      "slug":       "is_bot_probe_404",
      "flags":      [
      ],
      "conditions": {
        "logic": "AND",
        "group": [
          {
            "action": "is_not_logged_in_normal"
          },
          {
            "logic": "OR",
            "group": [
              {
                "action": "not_match_request_path",
                "params": {
                  "is_match_regex": true,
                  "match_paths":    [
                    "\\.(css|gif|jpg|jpeg|js|map|png|ttf|woff|woff2)$"
                  ]
                }
              },
              {
                "action": "is_request_to_invalid_plugin"
              },
              {
                "action": "is_request_to_invalid_theme"
              }
            ]
          }
        ]
      },
      "responses":  [
        {
          "action": "is_bot_probe_404"
        },
        {
          "action": "event_fire",
          "params": {
            "event":         "bottrack_404",
            "offense_count": 1,
            "block":         false
          }
        }
      ]
    },
    {
      "name":       "Bot-Track Fake Web Crawler",
      "slug":       "is_bot_probe_fakewebcrawler",
      "flags":      [
      ],
      "conditions": {
        "logic": "AND",
        "group": [
          {
            "action": "is_not_logged_in_normal"
          },
          {
            "action": "match_request_useragent",
            "params": {
              "match_useragents": [
                "Applebot/",
                "baidu",
                "bingbot",
                "Googlebot",
                "APIs-Google",
                "AdsBot-Google",
                "Mediapartners-Google",
                "PetalBot",
                "SemrushBot",
                "yandex.com/bots",
                "yahoo!"
              ]
            }
          },
          {
            "action":       "is_trusted_bot",
            "invert_match": true
          }
        ]
      },
      "responses":  [
        {
          "action": "is_bot_probe_404"
        },
        {
          "action": "event_fire",
          "params": {
            "event":         "bottrack_404",
            "offense_count": 1,
            "block":         false
          }
        }
      ]
    },
    {
      "name":       "Is XML-RPC",
      "slug":       "is_xmlrpc",
      "flags":      [
      ],
      "conditions": {
        "logic": "AND",
        "group": [
          {
            "action": "match_request_path",
            "params": {
              "is_match_regex": true,
              "match_paths":    [
                "/xmlrpc\\.php$"
              ]
            }
          },
          {
            "action": "wp_is_xmlrpc"
          }
        ]
      },
      "responses":  [
        {
          "action": "wp_is_xmlrpc"
        }
      ]
    }
  ]
}